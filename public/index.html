<!DOCTYPE html>
<html lang="ht">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1.0"/>
<title>CyberScan AI v2.0</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet"/>
<style>
:root{--bg:#0c0c14;--bg2:#111122;--bg3:#161630;--bg4:#1c1c3a;--green:#00ff88;--cyan:#00d4ff;--red:#ff2d55;--orange:#ff8800;--yellow:#ffd600;--text:#e0e0f0;--text2:#a0a0c0;--text3:#6a6a90;--glass:rgba(20,20,50,0.6);--border:rgba(0,255,136,0.15);--radius:12px;--radius2:16px}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'DM Sans',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;overflow-x:hidden}
#matrix-bg{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;opacity:0.06;pointer-events:none}
.app-container{position:relative;z-index:1;max-width:900px;margin:0 auto;padding:16px}
@keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
@keyframes glow{0%,100%{box-shadow:0 0 5px rgba(0,255,136,0.3)}50%{box-shadow:0 0 20px rgba(0,255,136,0.6)}}
@keyframes shimmer{0%{background-position:-200% 0}100%{background-position:200% 0}}
@keyframes pulse{0%,100%{opacity:1}50%{opacity:0.5}}
@keyframes scanline{0%{top:-10%}100%{top:110%}}
@keyframes slideIn{from{opacity:0;transform:translateX(100px)}to{opacity:1;transform:translateX(0)}}
@keyframes slideOut{from{opacity:1;transform:translateX(0)}to{opacity:0;transform:translateX(100px)}}
@keyframes progressPulse{0%,100%{opacity:0.8}50%{opacity:1}}
@keyframes matrixFall{0%{transform:translateY(-100%);opacity:1}100%{transform:translateY(100vh);opacity:0}}
.fade-in{animation:fadeInUp 0.4s ease}
.header{text-align:center;padding:24px 0 16px;animation:fadeInUp 0.5s ease}
.header h1{font-size:1.8rem;font-weight:700;background:linear-gradient(135deg,var(--green),var(--cyan));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
.header p{color:var(--text3);font-size:0.85rem;margin-top:4px}
.lang-bar{display:flex;justify-content:center;gap:6px;margin-bottom:12px}
.lang-btn{background:var(--glass);border:1px solid var(--border);color:var(--text2);padding:6px 14px;border-radius:8px;cursor:pointer;font-size:0.78rem;font-family:'DM Sans',sans-serif;transition:all 0.2s}
.lang-btn:hover{border-color:var(--green);color:var(--text)}
.lang-btn.active{background:rgba(0,255,136,0.1);border-color:var(--green);color:var(--green)}
.tab-bar{display:flex;gap:4px;overflow-x:auto;padding:4px;background:var(--glass);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:var(--radius);margin-bottom:16px;scrollbar-width:thin;scrollbar-color:var(--bg4) transparent}
.tab-bar::-webkit-scrollbar{height:4px}
.tab-bar::-webkit-scrollbar-track{background:transparent}
.tab-bar::-webkit-scrollbar-thumb{background:var(--bg4);border-radius:4px}
.tab-btn{flex:0 0 auto;min-width:fit-content;font-size:0.72rem;padding:8px 10px;background:transparent;border:1px solid transparent;border-radius:8px;color:var(--text3);cursor:pointer;font-family:'DM Sans',sans-serif;transition:all 0.2s;white-space:nowrap;display:flex;align-items:center;gap:4px}
.tab-btn .tab-label{display:inline}
.tab-btn:hover{color:var(--text);background:rgba(255,255,255,0.03)}
.tab-btn.active{background:rgba(0,255,136,0.1);border-color:var(--green);color:var(--green)}
@media(max-width:768px){.tab-btn{font-size:0.68rem;padding:6px 8px}.tab-btn .tab-label{display:none}}
.card{background:var(--glass);backdrop-filter:blur(20px);border:1px solid var(--border);border-radius:var(--radius2);padding:20px;margin-bottom:16px;animation:fadeInUp 0.4s ease}
.card-header{display:flex;align-items:center;gap:10px;margin-bottom:14px}
.card-header h2{font-size:1.1rem;font-weight:600}
.input-group{display:flex;gap:8px;margin-bottom:14px}
.input-field{flex:1;background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:12px 14px;color:var(--text);font-size:0.9rem;font-family:'DM Sans',sans-serif;outline:none;transition:border-color 0.2s}
.input-field:focus{border-color:var(--green)}
.input-field::placeholder{color:var(--text3)}
.btn{padding:12px 20px;border:none;border-radius:var(--radius);font-family:'DM Sans',sans-serif;font-weight:600;font-size:0.85rem;cursor:pointer;transition:all 0.2s;white-space:nowrap}
.btn-primary{background:linear-gradient(135deg,var(--green),#00cc6a);color:var(--bg)}
.btn-primary:hover{box-shadow:0 0 20px rgba(0,255,136,0.3);transform:translateY(-1px)}
.btn-primary:disabled{opacity:0.5;cursor:not-allowed;transform:none;box-shadow:none}
.btn-secondary{background:var(--bg3);color:var(--text2);border:1px solid var(--border)}
.btn-secondary:hover{border-color:var(--cyan);color:var(--cyan)}
.btn-sm{padding:6px 12px;font-size:0.75rem;border-radius:8px}
.btn-danger{background:rgba(255,45,85,0.15);color:var(--red);border:1px solid rgba(255,45,85,0.3)}
.btn-danger:hover{background:rgba(255,45,85,0.25)}
select.input-field{appearance:none;cursor:pointer;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%236a6a90' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center}
textarea.input-field{resize:vertical;min-height:80px}
.result-section{margin-top:16px;animation:fadeInUp 0.4s ease}
.result-block{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:14px;margin-bottom:12px}
.result-block h3{font-size:0.9rem;font-weight:600;margin-bottom:10px;display:flex;align-items:center;gap:8px}
.result-item{padding:10px 12px;margin-bottom:6px;background:rgba(0,0,0,0.2);border-radius:8px;font-size:0.85rem;line-height:1.5}
.severity{display:inline-flex;align-items:center;padding:3px 8px;border-radius:6px;font-size:0.7rem;font-weight:700;letter-spacing:0.5px;font-family:'DM Mono',monospace}
.severity.critical{background:rgba(255,45,85,0.2);color:var(--red)}
.severity.high{background:rgba(255,136,0,0.2);color:var(--orange)}
.severity.medium{background:rgba(255,214,0,0.2);color:var(--yellow)}
.severity.low{background:rgba(0,212,255,0.15);color:var(--cyan)}
.severity.info{background:rgba(0,255,136,0.1);color:var(--green)}
.progress-container{margin:12px 0}
.progress-bar{height:4px;background:var(--bg3);border-radius:4px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--green),var(--cyan));border-radius:4px;transition:width 0.3s ease;animation:progressPulse 1.5s ease infinite}
.skeleton{background:linear-gradient(90deg,var(--bg3) 25%,var(--bg4) 50%,var(--bg3) 75%);background-size:200% 100%;animation:shimmer 1.5s infinite;border-radius:8px;height:16px;margin-bottom:8px}
.toast-container{position:fixed;top:16px;right:16px;z-index:9999;display:flex;flex-direction:column;gap:8px}
.toast{padding:12px 16px;border-radius:var(--radius);backdrop-filter:blur(20px);font-size:0.82rem;animation:slideIn 0.3s ease;display:flex;align-items:center;gap:8px;max-width:360px;cursor:pointer}
.toast.exit{animation:slideOut 0.3s ease forwards}
.toast.success{background:rgba(0,255,136,0.15);border:1px solid rgba(0,255,136,0.3);color:var(--green)}
.toast.error{background:rgba(255,45,85,0.15);border:1px solid rgba(255,45,85,0.3);color:var(--red)}
.toast.info{background:rgba(0,212,255,0.15);border:1px solid rgba(0,212,255,0.3);color:var(--cyan)}
.modal-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.7);z-index:9998;display:flex;align-items:center;justify-content:center;animation:fadeInUp 0.2s ease}
.modal{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius2);padding:24px;width:90%;max-width:460px}
.modal h2{margin-bottom:16px;font-size:1.1rem}
.modal label{display:block;font-size:0.82rem;color:var(--text2);margin-bottom:6px;margin-top:12px}
.modal .input-field{width:100%;margin-bottom:4px}
.modal-actions{display:flex;gap:8px;margin-top:16px;justify-content:flex-end}
.stats-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:10px;margin-bottom:16px}
.stat-card{background:var(--bg2);border:1px solid var(--border);border-radius:var(--radius);padding:14px;text-align:center}
.stat-card .stat-icon{font-size:1.4rem;margin-bottom:6px}
.stat-card .stat-value{font-size:1.5rem;font-weight:700;font-family:'DM Mono',monospace;color:var(--green)}
.stat-card .stat-label{font-size:0.72rem;color:var(--text3);margin-top:2px}
.history-item{display:flex;align-items:center;gap:10px;padding:10px 12px;margin-bottom:6px;background:rgba(0,0,0,0.2);border-radius:8px;font-size:0.82rem;cursor:pointer;transition:background 0.2s}
.history-item:hover{background:rgba(0,0,0,0.4)}
.history-item .hi-icon{font-size:1.1rem}
.history-item .hi-target{flex:1;color:var(--text);font-family:'DM Mono',monospace;font-size:0.8rem}
.history-item .hi-time{color:var(--text3);font-size:0.72rem}
.history-item .hi-fav{cursor:pointer;font-size:1rem;opacity:0.5;transition:opacity 0.2s}
.history-item .hi-fav:hover,.history-item .hi-fav.active{opacity:1}
.disclaimer{background:rgba(255,214,0,0.06);border:1px solid rgba(255,214,0,0.15);border-radius:8px;padding:10px 14px;font-size:0.78rem;color:var(--yellow);margin-bottom:14px;line-height:1.5}
.gauge-container{display:flex;flex-direction:column;align-items:center;margin:16px 0}
.gauge-svg{width:200px;height:120px}
.gauge-label{font-size:0.82rem;color:var(--text2);margin-top:4px}
.password-details{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:12px}
.pwd-detail{background:var(--bg2);border-radius:8px;padding:10px 12px;font-size:0.8rem}
.pwd-detail .pwd-key{color:var(--text3);font-size:0.72rem}
.pwd-detail .pwd-val{color:var(--text);font-family:'DM Mono',monospace;margin-top:2px}
.cvss-container{display:flex;align-items:center;gap:16px;margin:12px 0}
.cvss-ring{width:80px;height:80px;position:relative}
.cvss-ring svg{transform:rotate(-90deg)}
.cvss-score{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2rem;font-weight:700;font-family:'DM Mono',monospace}
.api-warning{background:rgba(255,136,0,0.08);border:1px solid rgba(255,136,0,0.2);border-radius:var(--radius);padding:14px;text-align:center;color:var(--orange);font-size:0.85rem;margin-bottom:16px}
.api-warning a{color:var(--cyan);cursor:pointer;text-decoration:underline}
.toolbar{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:8px}
.footer{text-align:center;padding:20px 0;color:var(--text3);font-size:0.75rem}
.terminal-block{background:#0a0a12;border:1px solid rgba(0,255,136,0.2);border-radius:8px;padding:14px;font-family:'DM Mono',monospace;font-size:0.82rem;color:var(--green);margin:8px 0;overflow-x:auto;position:relative}
.terminal-block::before{content:'Terminal';position:absolute;top:-10px;left:12px;background:var(--bg3);padding:0 8px;font-size:0.65rem;color:var(--text3);letter-spacing:1px;text-transform:uppercase}
.terminal-block code{color:var(--cyan)}
.terminal-block .cmd-prompt{color:var(--red);margin-right:8px}
.command-item{padding:12px 14px;margin-bottom:8px;background:rgba(0,0,0,0.3);border-radius:8px;border-left:3px solid var(--cyan)}
.command-item .cmd-step{display:inline-flex;align-items:center;justify-content:center;width:24px;height:24px;border-radius:50%;background:var(--cyan);color:var(--bg);font-size:0.75rem;font-weight:700;margin-right:10px}
.command-item .cmd-text{font-family:'DM Mono',monospace;font-size:0.82rem;color:var(--green);background:rgba(0,255,136,0.05);padding:6px 10px;border-radius:6px;margin-top:6px;display:block}
.command-item .cmd-desc{font-size:0.82rem;color:var(--text2);margin-top:4px}
.tool-badge{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;border-radius:6px;font-size:0.7rem;font-weight:700;letter-spacing:0.5px;font-family:'DM Mono',monospace}
.tool-badge.exploit{background:rgba(255,45,85,0.15);color:var(--red);border:1px solid rgba(255,45,85,0.3)}
.tool-badge.auxiliary{background:rgba(0,212,255,0.12);color:var(--cyan);border:1px solid rgba(0,212,255,0.2)}
.tool-badge.post{background:rgba(255,136,0,0.15);color:var(--orange);border:1px solid rgba(255,136,0,0.3)}
.tool-badge.payload{background:rgba(255,214,0,0.15);color:var(--yellow);border:1px solid rgba(255,214,0,0.3)}
.proto-bar{display:flex;height:24px;border-radius:6px;overflow:hidden;margin:12px 0}
.proto-segment{display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:700;color:var(--bg);min-width:30px;transition:width 0.5s ease}
.packet-row{padding:8px 12px;margin-bottom:4px;background:rgba(0,0,0,0.2);border-radius:6px;font-family:'DM Mono',monospace;font-size:0.78rem;display:grid;grid-template-columns:80px 120px 120px 1fr 60px;gap:8px;align-items:center}
.packet-row.suspicious{border-left:3px solid var(--red);background:rgba(255,45,85,0.05)}
.packet-row .proto{color:var(--cyan);font-weight:600}
.dir-item{display:flex;align-items:center;gap:10px;padding:8px 12px;margin-bottom:4px;background:rgba(0,0,0,0.2);border-radius:6px;font-family:'DM Mono',monospace;font-size:0.82rem}
.dir-item .dir-status{width:36px;height:24px;display:flex;align-items:center;justify-content:center;border-radius:4px;font-size:0.72rem;font-weight:700}
.dir-item .dir-status.s200{background:rgba(0,255,136,0.15);color:var(--green)}
.dir-item .dir-status.s301{background:rgba(0,212,255,0.15);color:var(--cyan)}
.dir-item .dir-status.s403{background:rgba(255,136,0,0.15);color:var(--orange)}
.dir-item .dir-status.s500{background:rgba(255,45,85,0.15);color:var(--red)}
.dir-item .dir-path{color:var(--green);flex:1}
.dir-item.interesting{border-left:3px solid var(--yellow);background:rgba(255,214,0,0.03)}
@media(max-width:768px){.app-container{padding:10px}.header h1{font-size:1.4rem}.input-group{flex-direction:column}.btn{width:100%}.password-details{grid-template-columns:1fr}.stats-grid{grid-template-columns:repeat(2,1fr)}.packet-row{grid-template-columns:60px 80px 80px 1fr 50px;font-size:0.7rem}}
@media(max-width:480px){.header h1{font-size:1.2rem}.stats-grid{grid-template-columns:repeat(2,1fr)}.packet-row{grid-template-columns:1fr;gap:2px}}
</style>
</head>
<body>
<canvas id="matrix-bg"></canvas>
<div id="root"></div>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script type="text/babel">
const {useState, useEffect, useCallback, useMemo, useRef} = React;

// ===== TRANSLATIONS =====
const T = {
  ht: {
    scanner:"Eskan\u00e8", vuln:"Vilnerabilite", password:"Modpas", headers:"Ant\u00e8t",
    metasploit:"Metasploit", burpsuite:"Burp Suite", wireshark:"Wireshark", john:"John",
    sqlmap:"SQLMap", hydra:"Hydra", gobuster:"Gobuster", stats:"Estatistik",
    title:"CyberScan AI", subtitle:"Analiz Sekirite Siber\u00e8tik",
    settings:"Param\u00e8t", apiKey:"Kle API", save:"Anrejistre", cancel:"Anile",
    scan:"Analize", scanning:"Ap analize...", export:"Ekspote",
    noKey:"Ou bezwen yon kle API Claude pou itilize zouti sa a",
    getKey:"Jwenn kle API",
    offlineMode:"Mod Offline", offlineDesc:"Itilize done ki nan kach",
    // Scanner
    scannerTitle:"Eskan\u00e8 Rezo", scannerInput:"IP oswa domaine", scannerPlaceholder:"ex: 192.168.1.1 oswa example.com",
    scannerBtn:"Eskan\u00e8", scannerScanning:"Ap eskan\u00e8...",
    ports:"P\u00f2", services:"S\u00e8vis", os:"Sist\u00e8m", risks:"Risk",
    // Vuln
    vulnTitle:"Verifikasyon Vilnerabilite", vulnInput:"Lojisy\u00e8l / Sist\u00e8m",
    vulnPlaceholder:"ex: Apache 2.4.49, Windows Server 2019", vulnBtn:"Verifye",
    vulnScanning:"Ap verifye...", cves:"CVE yo", vulnRisks:"Risk", vulnPatches:"Patch",
    // Password
    pwdTitle:"Analiz Modpas", pwdInput:"Antre modpas ou", pwdPlaceholder:"Tape modpas...",
    pwdStrength:"F\u00f2s", pwdLength:"Long\u00e8", pwdEntropy:"Entropi", pwdCrackTime:"Tan pou Krake",
    pwdUpper:"Maj\u00edskil", pwdLower:"Min\u00edskil", pwdNumbers:"Chif", pwdSymbols:"Senb\u00f2l",
    pwdSuggestions:"Sijesyon",
    // Headers
    headersTitle:"Analiz Ant\u00e8t", headersInput:"URL sit w\u00e8b",
    headersPlaceholder:"ex: example.com", headersBtn:"Analize", headersScanning:"Ap analize...",
    headersFound:"Ant\u00e8t Jwenn", headersMissing:"Ant\u00e8t ki Manke", headersScore:"Nivo Sekirite",
    // Metasploit
    msTitle:"Metasploit Framework", msInput:"Sib (IP/Dom\u00e8n/S\u00e8vis)",
    msPlaceholder:"ex: 192.168.1.1, ftp, apache 2.4", msBtn:"Analize Sib",
    msScanning:"Ap analize ak Metasploit...", msModules:"Modil yo", msPayloads:"Payload yo",
    msAttackPlan:"Plan Atak", msPostExploit:"Post-Eksplwatasyon", msRecommend:"Rekomandasyon",
    msDisclaimer:"Zouti sa a bay analiz edikasyon\u00e8l s\u00e8lman. Okenn vrE komannd pa egzekite. Itilize pou aprantisaj sekirite.",
    // BurpSuite
    bsTitle:"Burp Suite Scanner", bsInput:"URL Aplikasyon W\u00e8b",
    bsPlaceholder:"ex: https://example.com/app", bsBtn:"Eskan\u00e8 W\u00e8b",
    bsScanning:"Ap eskan\u00e8 ak Burp Suite...", bsVulns:"Vilnerabilite", bsFindings:"Rezilta",
    bsSiteMap:"Kat Sit", bsRecommend:"Rekomandasyon", bsRisk:"Risk Jeneral",
    bsDisclaimer:"Analiz edikasyon\u00e8l s\u00e8lman. Pa yon vrE eskan sekirite w\u00e8b.",
    // Wireshark
    wsTitle:"Wireshark Analiz", wsInput:"IP/Rezo/Pwotok\u00f2l",
    wsPlaceholder:"ex: 192.168.1.0/24, HTTP, DNS", wsBtn:"Analize Trafik",
    wsScanning:"Ap analize ak Wireshark...", wsPackets:"Pak\u00e8 yo", wsProtocols:"Pwotok\u00f2l",
    wsAnomalies:"Anomali", wsFilters:"Filt\u00e8",
    wsDisclaimer:"Simulasyon edikasyon\u00e8l. Pa vrE kaptire pak\u00e8 rezo.",
    // John
    jrTitle:"John the Ripper", jrInput:"Tip Hash / Alg\u00f2ritm",
    jrPlaceholder:"ex: MD5, SHA-256, bcrypt, NTLM", jrBtn:"Analize Hash",
    jrScanning:"Ap analize ak John...", jrHashInfo:"Enf\u00f2masyon Hash", jrMethodology:"Metod\u00f2loji",
    jrWordlists:"Lis Mo", jrRules:"R\u00e8g yo", jrTime:"Tan Estime", jrRecommend:"Rekomandasyon",
    jrDisclaimer:"Analiz edikasyon\u00e8l s\u00e8lman. Pa vrE krake modpas.",
    // SQLMap
    sqTitle:"SQLMap Analiz", sqInput:"URL ak Param\u00e8t",
    sqPlaceholder:"ex: http://site.com/page?id=1", sqBtn:"Teste Enjeksyon",
    sqScanning:"Ap analize ak SQLMap...", sqInjections:"Pwen Enjeksyon", sqDatabases:"Baz Done",
    sqCommands:"Komannd", sqWaf:"Deteksyon WAF", sqRisk:"Nivo Risk", sqRecommend:"Rekomandasyon",
    sqDisclaimer:"Analiz edikasyon\u00e8l s\u00e8lman. Pa vrE egzekite enjeksyon SQL.",
    // Hydra
    hyTitle:"Hydra Brute Force", hyInput:"IP + S\u00e8vis",
    hyPlaceholder:"ex: 192.168.1.1 SSH, ftp://target.com", hyBtn:"Analize S\u00e8vis",
    hyScanning:"Ap analize ak Hydra...", hyMethodology:"Metod\u00f2loji", hyWordlists:"Lis Mo",
    hyOptions:"Opsyon", hyDefenses:"Def\u00e0ns", hyTime:"Tan Estime", hyRecommend:"Rekomandasyon",
    hyDisclaimer:"Analiz edikasyon\u00e8l s\u00e8lman. Pa vrE f\u00e8 atak brute force.",
    // Gobuster
    gbTitle:"Gobuster Scanner", gbInput:"URL Sit W\u00e8b",
    gbPlaceholder:"ex: https://example.com", gbBtn:"Eskan\u00e8 Repet\u00e8",
    gbScanning:"Ap eskan\u00e8 ak Gobuster...", gbDirs:"Repet\u00e8 / Fichye", gbCommands:"Komannd",
    gbWordlists:"Lis Mo", gbHidden:"Dekouvr\u00e8t Kache", gbRecommend:"Rekomandasyon",
    gbDisclaimer:"Analiz edikasyon\u00e8l s\u00e8lman. Pa vrE eskan\u00e8 repet\u00e8.",
    // Stats
    statsTitle:"Estatistik", totalScans:"Total Eskan", favorites:"Favori",
    mostScanned:"Plis Eskan\u00e8", clearHistory:"Efase Istwa", clearConfirm:"Efase tout istwa?",
    noHistory:"Pa gen istwa ank\u00f2"
  },
  fr: {
    scanner:"Scanner", vuln:"Vuln\u00e9rabilit\u00e9s", password:"Mot de passe", headers:"En-t\u00eates",
    metasploit:"Metasploit", burpsuite:"Burp Suite", wireshark:"Wireshark", john:"John",
    sqlmap:"SQLMap", hydra:"Hydra", gobuster:"Gobuster", stats:"Statistiques",
    title:"CyberScan AI", subtitle:"Analyse de Cybers\u00e9curit\u00e9",
    settings:"Param\u00e8tres", apiKey:"Cl\u00e9 API", save:"Enregistrer", cancel:"Annuler",
    scan:"Analyser", scanning:"Analyse en cours...", export:"Exporter",
    noKey:"Vous avez besoin d'une cl\u00e9 API Claude pour utiliser cet outil",
    getKey:"Obtenir une cl\u00e9 API",
    offlineMode:"Mode Hors-ligne", offlineDesc:"Utiliser les donn\u00e9es en cache",
    scannerTitle:"Scanner R\u00e9seau", scannerInput:"IP ou domaine", scannerPlaceholder:"ex: 192.168.1.1 ou example.com",
    scannerBtn:"Scanner", scannerScanning:"Scan en cours...",
    ports:"Ports", services:"Services", os:"Syst\u00e8me", risks:"Risques",
    vulnTitle:"V\u00e9rification de Vuln\u00e9rabilit\u00e9s", vulnInput:"Logiciel / Syst\u00e8me",
    vulnPlaceholder:"ex: Apache 2.4.49, Windows Server 2019", vulnBtn:"V\u00e9rifier",
    vulnScanning:"V\u00e9rification en cours...", cves:"CVE", vulnRisks:"Risques", vulnPatches:"Correctifs",
    pwdTitle:"Analyse de Mot de Passe", pwdInput:"Entrez votre mot de passe", pwdPlaceholder:"Tapez un mot de passe...",
    pwdStrength:"Force", pwdLength:"Longueur", pwdEntropy:"Entropie", pwdCrackTime:"Temps de Crack",
    pwdUpper:"Majuscules", pwdLower:"Minuscules", pwdNumbers:"Chiffres", pwdSymbols:"Symboles",
    pwdSuggestions:"Suggestions",
    headersTitle:"Analyse d'En-t\u00eates", headersInput:"URL du site web",
    headersPlaceholder:"ex: example.com", headersBtn:"Analyser", headersScanning:"Analyse en cours...",
    headersFound:"En-t\u00eates Trouv\u00e9s", headersMissing:"En-t\u00eates Manquants", headersScore:"Score de S\u00e9curit\u00e9",
    msTitle:"Metasploit Framework", msInput:"Cible (IP/Domaine/Service)",
    msPlaceholder:"ex: 192.168.1.1, ftp, apache 2.4", msBtn:"Analyser Cible",
    msScanning:"Analyse Metasploit en cours...", msModules:"Modules", msPayloads:"Payloads",
    msAttackPlan:"Plan d'Attaque", msPostExploit:"Post-Exploitation", msRecommend:"Recommandations",
    msDisclaimer:"Analyse \u00e9ducative uniquement. Aucune commande r\u00e9elle n'est ex\u00e9cut\u00e9e.",
    bsTitle:"Burp Suite Scanner", bsInput:"URL de l'Application Web",
    bsPlaceholder:"ex: https://example.com/app", bsBtn:"Scanner Web",
    bsScanning:"Scan Burp Suite en cours...", bsVulns:"Vuln\u00e9rabilit\u00e9s", bsFindings:"R\u00e9sultats",
    bsSiteMap:"Carte du Site", bsRecommend:"Recommandations", bsRisk:"Risque Global",
    bsDisclaimer:"Analyse \u00e9ducative uniquement. Pas un vrai scan de s\u00e9curit\u00e9 web.",
    wsTitle:"Analyse Wireshark", wsInput:"IP/R\u00e9seau/Protocole",
    wsPlaceholder:"ex: 192.168.1.0/24, HTTP, DNS", wsBtn:"Analyser Trafic",
    wsScanning:"Analyse Wireshark en cours...", wsPackets:"Paquets", wsProtocols:"Protocoles",
    wsAnomalies:"Anomalies", wsFilters:"Filtres",
    wsDisclaimer:"Simulation \u00e9ducative. Pas de vraie capture de paquets.",
    jrTitle:"John the Ripper", jrInput:"Type de Hash / Algorithme",
    jrPlaceholder:"ex: MD5, SHA-256, bcrypt, NTLM", jrBtn:"Analyser Hash",
    jrScanning:"Analyse John en cours...", jrHashInfo:"Info Hash", jrMethodology:"M\u00e9thodologie",
    jrWordlists:"Listes de Mots", jrRules:"R\u00e8gles", jrTime:"Temps Estim\u00e9", jrRecommend:"Recommandations",
    jrDisclaimer:"Analyse \u00e9ducative uniquement. Aucun mot de passe n'est r\u00e9ellement craqu\u00e9.",
    sqTitle:"Analyse SQLMap", sqInput:"URL avec Param\u00e8tre",
    sqPlaceholder:"ex: http://site.com/page?id=1", sqBtn:"Tester Injection",
    sqScanning:"Analyse SQLMap en cours...", sqInjections:"Points d'Injection", sqDatabases:"Bases de Donn\u00e9es",
    sqCommands:"Commandes", sqWaf:"D\u00e9tection WAF", sqRisk:"Niveau de Risque", sqRecommend:"Recommandations",
    sqDisclaimer:"Analyse \u00e9ducative uniquement. Aucune injection SQL r\u00e9ellement ex\u00e9cut\u00e9e.",
    hyTitle:"Hydra Brute Force", hyInput:"IP + Service",
    hyPlaceholder:"ex: 192.168.1.1 SSH, ftp://target.com", hyBtn:"Analyser Service",
    hyScanning:"Analyse Hydra en cours...", hyMethodology:"M\u00e9thodologie", hyWordlists:"Listes de Mots",
    hyOptions:"Options", hyDefenses:"D\u00e9fenses", hyTime:"Temps Estim\u00e9", hyRecommend:"Recommandations",
    hyDisclaimer:"Analyse \u00e9ducative uniquement. Aucune attaque brute force r\u00e9ellement effectu\u00e9e.",
    gbTitle:"Gobuster Scanner", gbInput:"URL du Site Web",
    gbPlaceholder:"ex: https://example.com", gbBtn:"Scanner R\u00e9pertoires",
    gbScanning:"Scan Gobuster en cours...", gbDirs:"R\u00e9pertoires / Fichiers", gbCommands:"Commandes",
    gbWordlists:"Listes de Mots", gbHidden:"D\u00e9couvertes Cach\u00e9es", gbRecommend:"Recommandations",
    gbDisclaimer:"Analyse \u00e9ducative uniquement. Pas de vrai scan de r\u00e9pertoires.",
    statsTitle:"Statistiques", totalScans:"Total Scans", favorites:"Favoris",
    mostScanned:"Plus Scann\u00e9", clearHistory:"Effacer l'Historique", clearConfirm:"Effacer tout l'historique ?",
    noHistory:"Aucun historique"
  },
  en: {
    scanner:"Scanner", vuln:"Vulnerabilities", password:"Password", headers:"Headers",
    metasploit:"Metasploit", burpsuite:"Burp Suite", wireshark:"Wireshark", john:"John",
    sqlmap:"SQLMap", hydra:"Hydra", gobuster:"Gobuster", stats:"Statistics",
    title:"CyberScan AI", subtitle:"Cybersecurity Analysis",
    settings:"Settings", apiKey:"API Key", save:"Save", cancel:"Cancel",
    scan:"Analyze", scanning:"Analyzing...", export:"Export",
    noKey:"You need a Claude API key to use this tool",
    getKey:"Get API Key",
    offlineMode:"Offline Mode", offlineDesc:"Use cached data",
    scannerTitle:"Network Scanner", scannerInput:"IP or domain", scannerPlaceholder:"e.g. 192.168.1.1 or example.com",
    scannerBtn:"Scan", scannerScanning:"Scanning...",
    ports:"Ports", services:"Services", os:"System", risks:"Risks",
    vulnTitle:"Vulnerability Check", vulnInput:"Software / System",
    vulnPlaceholder:"e.g. Apache 2.4.49, Windows Server 2019", vulnBtn:"Check",
    vulnScanning:"Checking...", cves:"CVEs", vulnRisks:"Risks", vulnPatches:"Patches",
    pwdTitle:"Password Analyzer", pwdInput:"Enter your password", pwdPlaceholder:"Type a password...",
    pwdStrength:"Strength", pwdLength:"Length", pwdEntropy:"Entropy", pwdCrackTime:"Crack Time",
    pwdUpper:"Uppercase", pwdLower:"Lowercase", pwdNumbers:"Numbers", pwdSymbols:"Symbols",
    pwdSuggestions:"Suggestions",
    headersTitle:"Header Analyzer", headersInput:"Website URL",
    headersPlaceholder:"e.g. example.com", headersBtn:"Analyze", headersScanning:"Analyzing...",
    headersFound:"Headers Found", headersMissing:"Missing Headers", headersScore:"Security Score",
    msTitle:"Metasploit Framework", msInput:"Target (IP/Domain/Service)",
    msPlaceholder:"e.g. 192.168.1.1, ftp, apache 2.4", msBtn:"Analyze Target",
    msScanning:"Analyzing with Metasploit...", msModules:"Modules", msPayloads:"Payloads",
    msAttackPlan:"Attack Plan", msPostExploit:"Post-Exploitation", msRecommend:"Recommendations",
    msDisclaimer:"Educational analysis only. No real commands are executed. Use for security learning.",
    bsTitle:"Burp Suite Scanner", bsInput:"Web Application URL",
    bsPlaceholder:"e.g. https://example.com/app", bsBtn:"Scan Web",
    bsScanning:"Scanning with Burp Suite...", bsVulns:"Vulnerabilities", bsFindings:"Findings",
    bsSiteMap:"Site Map", bsRecommend:"Recommendations", bsRisk:"Overall Risk",
    bsDisclaimer:"Educational analysis only. Not a real web security scan.",
    wsTitle:"Wireshark Analysis", wsInput:"IP/Network/Protocol",
    wsPlaceholder:"e.g. 192.168.1.0/24, HTTP, DNS", wsBtn:"Analyze Traffic",
    wsScanning:"Analyzing with Wireshark...", wsPackets:"Packets", wsProtocols:"Protocols",
    wsAnomalies:"Anomalies", wsFilters:"Filters",
    wsDisclaimer:"Educational simulation. No real packet capture.",
    jrTitle:"John the Ripper", jrInput:"Hash Type / Algorithm",
    jrPlaceholder:"e.g. MD5, SHA-256, bcrypt, NTLM", jrBtn:"Analyze Hash",
    jrScanning:"Analyzing with John...", jrHashInfo:"Hash Info", jrMethodology:"Methodology",
    jrWordlists:"Wordlists", jrRules:"Rules", jrTime:"Estimated Time", jrRecommend:"Recommendations",
    jrDisclaimer:"Educational analysis only. No real password cracking.",
    sqTitle:"SQLMap Analysis", sqInput:"URL with Parameter",
    sqPlaceholder:"e.g. http://site.com/page?id=1", sqBtn:"Test Injection",
    sqScanning:"Analyzing with SQLMap...", sqInjections:"Injection Points", sqDatabases:"Databases",
    sqCommands:"Commands", sqWaf:"WAF Detection", sqRisk:"Risk Level", sqRecommend:"Recommendations",
    sqDisclaimer:"Educational analysis only. No real SQL injection executed.",
    hyTitle:"Hydra Brute Force", hyInput:"IP + Service",
    hyPlaceholder:"e.g. 192.168.1.1 SSH, ftp://target.com", hyBtn:"Analyze Service",
    hyScanning:"Analyzing with Hydra...", hyMethodology:"Methodology", hyWordlists:"Wordlists",
    hyOptions:"Options", hyDefenses:"Defenses", hyTime:"Estimated Time", hyRecommend:"Recommendations",
    hyDisclaimer:"Educational analysis only. No real brute force attacks performed.",
    gbTitle:"Gobuster Scanner", gbInput:"Website URL",
    gbPlaceholder:"e.g. https://example.com", gbBtn:"Scan Directories",
    gbScanning:"Scanning with Gobuster...", gbDirs:"Directories / Files", gbCommands:"Commands",
    gbWordlists:"Wordlists", gbHidden:"Hidden Discoveries", gbRecommend:"Recommendations",
    gbDisclaimer:"Educational analysis only. No real directory scanning.",
    statsTitle:"Statistics", totalScans:"Total Scans", favorites:"Favorites",
    mostScanned:"Most Scanned", clearHistory:"Clear History", clearConfirm:"Clear all history?",
    noHistory:"No history yet"
  }
};

// ===== UTILITY FUNCTIONS =====
function generateId(){return Date.now().toString(36)+Math.random().toString(36).slice(2)}
function getCacheKey(type,input){return 'cyberscan_cache_'+type+'_'+btoa(unescape(encodeURIComponent(input))).slice(0,40)}

async function callClaude(apiKey,systemPrompt,userMessage){
  const resp=await fetch('https://api.anthropic.com/v1/messages',{
    method:'POST',
    headers:{
      'Content-Type':'application/json',
      'x-api-key':apiKey,
      'anthropic-version':'2023-06-01',
      'anthropic-dangerous-direct-browser-access':'true'
    },
    body:JSON.stringify({
      model:'claude-sonnet-4-20250514',
      max_tokens:4096,
      system:systemPrompt,
      messages:[{role:'user',content:userMessage}]
    })
  });
  if(!resp.ok){const e=await resp.text();throw new Error('API Error: '+resp.status+' '+e)}
  const data=await resp.json();
  const raw=data.content[0].text;
  const m=raw.match(/\{[\s\S]*\}/);
  if(!m)throw new Error('Invalid JSON response');
  return JSON.parse(m[0]);
}

function analyzePassword(pwd){
  const len=pwd.length;
  const upper=(pwd.match(/[A-Z]/g)||[]).length;
  const lower=(pwd.match(/[a-z]/g)||[]).length;
  const numbers=(pwd.match(/[0-9]/g)||[]).length;
  const symbols=(pwd.match(/[^A-Za-z0-9]/g)||[]).length;
  let pool=0;
  if(upper>0)pool+=26;if(lower>0)pool+=26;if(numbers>0)pool+=10;if(symbols>0)pool+=33;
  const entropy=pool>0?Math.round(len*Math.log2(pool)):0;
  let score=0;
  if(len>=8)score+=15;if(len>=12)score+=15;if(len>=16)score+=10;
  if(upper>0)score+=10;if(lower>0)score+=10;if(numbers>0)score+=10;if(symbols>0)score+=15;
  if(entropy>=40)score+=5;if(entropy>=60)score+=5;if(entropy>=80)score+=5;
  const common=['password','123456','qwerty','abc123','letmein','admin','welcome','monkey'];
  if(common.includes(pwd.toLowerCase()))score=Math.min(score,5);
  if(/(.)\1{2,}/.test(pwd))score=Math.max(0,score-10);
  if(/^(012|123|234|345|456|567|678|789|890|abc|bcd|cde|def)/.test(pwd.toLowerCase()))score=Math.max(0,score-10);
  score=Math.min(100,Math.max(0,score));
  const combos=Math.pow(pool||1,len);
  const guessesPerSec=1e10;
  const seconds=combos/guessesPerSec;
  return{score,entropy,length:len,upper,lower,numbers,symbols,crackTime:seconds,pool};
}

function formatCrackTime(seconds){
  if(seconds<1)return'< 1 second';
  if(seconds<60)return Math.round(seconds)+' seconds';
  if(seconds<3600)return Math.round(seconds/60)+' minutes';
  if(seconds<86400)return Math.round(seconds/3600)+' hours';
  if(seconds<31536000)return Math.round(seconds/86400)+' days';
  if(seconds<31536000*100)return Math.round(seconds/31536000)+' years';
  if(seconds<31536000*1e6)return Math.round(seconds/31536000/1000)+'K years';
  if(seconds<31536000*1e9)return Math.round(seconds/31536000/1e6)+'M years';
  return'centuries+';
}

function getStrengthLevel(score){
  if(score>=80)return'excellent';if(score>=60)return'good';if(score>=40)return'fair';if(score>=20)return'weak';return'critical';
}

function getStrengthColor(level){
  const c={excellent:'#00ff88',good:'#00d4ff',fair:'#ffd600',weak:'#ff8800',critical:'#ff2d55'};
  return c[level]||'#ff2d55';
}

function initMatrix(){
  const canvas=document.getElementById('matrix-bg');
  if(!canvas)return;
  const ctx=canvas.getContext('2d');
  canvas.width=window.innerWidth;canvas.height=window.innerHeight;
  const cols=Math.floor(canvas.width/14);
  const drops=Array(cols).fill(1);
  const chars='01アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲン';
  function draw(){
    ctx.fillStyle='rgba(12,12,20,0.05)';ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle='#00ff88';ctx.font='12px DM Mono,monospace';
    for(let i=0;i<drops.length;i++){
      const t=chars[Math.floor(Math.random()*chars.length)];
      ctx.fillText(t,i*14,drops[i]*14);
      if(drops[i]*14>canvas.height&&Math.random()>0.975)drops[i]=0;
      drops[i]++;
    }
  }
  setInterval(draw,33);
  window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight});
}

// ===== SMALL COMPONENTS =====
function ToastContainer({toasts,removeToast}){
  return React.createElement('div',{className:'toast-container'},
    toasts.map(t=>React.createElement('div',{
      key:t.id,className:'toast '+(t.exiting?'exit ':'')+t.type,
      onClick:()=>removeToast(t.id)
    },t.type==='success'?'\u2713':t.type==='error'?'\u2717':'\u2139',' ',t.message))
  );
}

function SettingsModal({t,apiKey,setApiKey,lang,setLang,offlineMode,setOfflineMode,onClose}){
  const[key,setKey]=useState(apiKey);
  const save=()=>{setApiKey(key);localStorage.setItem('cyberscan_apikey',key);onClose()};
  return React.createElement('div',{className:'modal-overlay',onClick:e=>{if(e.target===e.currentTarget)onClose()}},
    React.createElement('div',{className:'modal'},
      React.createElement('h2',null,'\u2699\ufe0f ',t.settings),
      React.createElement('label',null,t.apiKey),
      React.createElement('input',{type:'password',className:'input-field',value:key,onChange:e=>setKey(e.target.value),placeholder:'sk-ant-...'}),
      React.createElement('label',null,React.createElement('input',{type:'checkbox',checked:offlineMode,onChange:e=>setOfflineMode(e.target.checked),style:{marginRight:8}}),t.offlineMode),
      React.createElement('p',{style:{fontSize:'0.75rem',color:'var(--text3)',marginTop:4}},t.offlineDesc),
      React.createElement('div',{className:'modal-actions'},
        React.createElement('button',{className:'btn btn-secondary',onClick:onClose},t.cancel),
        React.createElement('button',{className:'btn btn-primary',onClick:save},t.save)
      )
    )
  );
}

function ProgressBar({progress}){
  return React.createElement('div',{className:'progress-container'},
    React.createElement('div',{className:'progress-bar'},
      React.createElement('div',{className:'progress-fill',style:{width:progress+'%'}})
    )
  );
}

function LoadingSkeleton(){
  return React.createElement('div',null,
    React.createElement('div',{className:'skeleton',style:{width:'80%',height:20}}),
    React.createElement('div',{className:'skeleton',style:{width:'60%'}}),
    React.createElement('div',{className:'skeleton',style:{width:'90%'}}),
    React.createElement('div',{className:'skeleton',style:{width:'45%'}})
  );
}

function PasswordGauge({score,level,color}){
  const pct=score/100;
  const angle=-90+(pct*180);
  const r=80;const cx=100;const cy=95;
  const rad=d=>(d*Math.PI)/180;
  const x1=cx+r*Math.cos(rad(-180));const y1=cy+r*Math.sin(rad(-180));
  const x2=cx+r*Math.cos(rad(angle-180));const y2=cy+r*Math.sin(rad(angle-180));
  const large=pct>0.5?1:0;
  const pathD=`M ${x1} ${y1} A ${r} ${r} 0 ${large} 1 ${x2} ${y2}`;
  return React.createElement('div',{className:'gauge-container'},
    React.createElement('svg',{className:'gauge-svg',viewBox:'0 0 200 120'},
      React.createElement('path',{d:`M 20 95 A 80 80 0 0 1 180 95`,fill:'none',stroke:'var(--bg3)',strokeWidth:8,strokeLinecap:'round'}),
      React.createElement('path',{d:pathD,fill:'none',stroke:color,strokeWidth:8,strokeLinecap:'round',style:{filter:`drop-shadow(0 0 6px ${color})`}}),
      React.createElement('text',{x:100,y:80,textAnchor:'middle',fill:color,fontSize:28,fontWeight:700,fontFamily:'DM Mono'},score),
      React.createElement('text',{x:100,y:100,textAnchor:'middle',fill:'var(--text2)',fontSize:11},level.toUpperCase())
    )
  );
}

function CvssGauge({score,color}){
  const r=32;const c=2*Math.PI*r;const pct=score/10;const offset=c-(pct*c);
  return React.createElement('div',{className:'cvss-ring'},
    React.createElement('svg',{width:80,height:80},
      React.createElement('circle',{cx:40,cy:40,r:r,fill:'none',stroke:'var(--bg3)',strokeWidth:6}),
      React.createElement('circle',{cx:40,cy:40,r:r,fill:'none',stroke:color,strokeWidth:6,strokeDasharray:c,strokeDashoffset:offset,strokeLinecap:'round'})
    ),
    React.createElement('span',{className:'cvss-score',style:{color}},score.toFixed(1))
  );
}

// ===== NETWORK SCANNER =====
function NetworkScanner({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a target','error');
    const ck=getCacheKey('scanner',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*15,90)),400);
    try{
      const data=await callClaude(apiKey,
        'You are a network security scanner expert. Analyze the target and provide a simulated scan report. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","ports":[{"port":number,"state":"open|closed|filtered","service":"string","version":"string"}],"os":{"name":"string","accuracy":"string"},"services":[{"name":"string","version":"string","risk":"high|medium|low"}],"risks":[{"title":"string","severity":"critical|high|medium|low","description":"string"}],"summary":"string"}. Provide 8-12 ports, 4-6 services, 4-6 risks.',
        'Scan target: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'scanner',target,timestamp:Date.now()});
      addToast('Scan complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Network Scan: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}table{border-collapse:collapse;width:100%}td,th{border:1px solid #333;padding:8px;text-align:left}th{background:#222}</style></head><body><h1>Network Scan: '+result.target+'</h1><p>'+result.summary+'</p><h2>Ports</h2><table><tr><th>Port</th><th>State</th><th>Service</th><th>Version</th></tr>'+(result.ports||[]).map(p=>'<tr><td>'+p.port+'</td><td>'+p.state+'</td><td>'+p.service+'</td><td>'+(p.version||'')+'</td></tr>').join('')+'</table><h2>Risks</h2>'+(result.risks||[]).map(r=>'<div style="margin:8px 0;padding:10px;background:#1a1a2e;border-left:3px solid '+(r.severity==='critical'?'#f25':r.severity==='high'?'#f80':'#0df')+'"><strong>'+r.title+'</strong> ['+r.severity+']<br/>'+r.description+'</div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='scan_'+result.target+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udd0d ',t.scannerTitle)),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.scannerPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.scannerScanning:t.scannerBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee1\ufe0f ',t.ports,' (',((result.ports||[]).length),')'),
        (result.ports||[]).map((p,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('span',{style:{color:'var(--cyan)',fontFamily:'DM Mono',marginRight:8}},p.port),
          React.createElement('span',{className:'severity '+(p.state==='open'?'high':p.state==='filtered'?'medium':'low')},p.state),
          ' ',p.service,' ',React.createElement('span',{style:{color:'var(--text3)'}},p.version||'')
        ))
      ),
      result.os&&React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcbb ',t.os),
        React.createElement('div',{className:'result-item'},result.os.name,' (',result.os.accuracy,')')
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u26a0\ufe0f ',t.risks),
        (result.risks||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('span',{className:'severity '+r.severity},r.severity),' ',
          React.createElement('strong',null,r.title),
          React.createElement('div',{style:{color:'var(--text2)',marginTop:4,fontSize:'0.82rem'}},r.description)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== VULN CHECK =====
function VulnCheck({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a target','error');
    const ck=getCacheKey('vuln',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*15,90)),400);
    try{
      const data=await callClaude(apiKey,
        'You are a vulnerability assessment expert. Analyze the software/system for known vulnerabilities. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","cves":[{"id":"string","severity":"critical|high|medium|low","cvss":number,"description":"string","affected":"string","remediation":"string"}],"risks":[{"title":"string","severity":"critical|high|medium|low","description":"string"}],"patches":[{"name":"string","description":"string","priority":"critical|high|medium|low"}],"overallRisk":"critical|high|medium|low","summary":"string"}. Provide 5-8 CVEs, 3-5 risks, 3-5 patches.',
        'Check vulnerabilities for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'vuln',target,timestamp:Date.now()});
      addToast('Vulnerability check complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Vuln Report: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}.cve{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}</style></head><body><h1>Vulnerability Report: '+result.target+'</h1><p>Overall Risk: '+result.overallRisk+'</p><p>'+result.summary+'</p><h2>CVEs</h2>'+(result.cves||[]).map(c=>'<div class="cve"><strong>'+c.id+'</strong> [CVSS: '+c.cvss+'] ['+c.severity+']<br/>'+c.description+'<br/><em>Fix: '+c.remediation+'</em></div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='vuln_'+result.target+'.html';a.click();URL.revokeObjectURL(u);
  };

  const cvssColor=s=>s>=9?'var(--red)':s>=7?'var(--orange)':s>=4?'var(--yellow)':'var(--cyan)';

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udee1\ufe0f ',t.vulnTitle)),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.vulnPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.vulnScanning:t.vulnBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udd13 ',t.cves,' (',((result.cves||[]).length),')'),
        (result.cves||[]).map((c,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6}},
            React.createElement(CvssGauge,{score:c.cvss,color:cvssColor(c.cvss)}),
            React.createElement('div',null,
              React.createElement('strong',{style:{color:'var(--cyan)'}},c.id),
              React.createElement('span',{className:'severity '+c.severity,style:{marginLeft:8}},c.severity)
            )
          ),
          React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.82rem'}},c.description),
          React.createElement('p',{style:{color:'var(--green)',fontSize:'0.8rem',marginTop:4}},'\u2192 ',c.remediation)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udce6 ',t.vulnPatches),
        (result.patches||[]).map((p,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('span',{className:'severity '+p.priority},p.priority),' ',
          React.createElement('strong',null,p.name),
          React.createElement('div',{style:{color:'var(--text2)',marginTop:4,fontSize:'0.82rem'}},p.description)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== PASSWORD ANALYZER =====
function PasswordAnalyzer({t}){
  const[pwd,setPwd]=useState('');
  const[show,setShow]=useState(false);
  const result=useMemo(()=>pwd?analyzePassword(pwd):null,[pwd]);
  const level=result?getStrengthLevel(result.score):'';
  const color=result?getStrengthColor(level):'';

  const suggestions=useMemo(()=>{
    if(!result)return[];
    const s=[];
    if(result.length<12)s.push('Use at least 12 characters');
    if(result.upper===0)s.push('Add uppercase letters');
    if(result.lower===0)s.push('Add lowercase letters');
    if(result.numbers===0)s.push('Add numbers');
    if(result.symbols===0)s.push('Add special symbols');
    if(result.entropy<60)s.push('Increase variety for more entropy');
    return s;
  },[result]);

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udd10 ',t.pwdTitle)),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{type:show?'text':'password',className:'input-field',value:pwd,onChange:e=>setPwd(e.target.value),placeholder:t.pwdPlaceholder}),
        React.createElement('button',{className:'btn btn-secondary',onClick:()=>setShow(!show)},show?'\ud83d\ude48':'\ud83d\udc41\ufe0f')
      )
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'card'},
        React.createElement(PasswordGauge,{score:result.score,level,color}),
        React.createElement('div',{className:'password-details'},
          React.createElement('div',{className:'pwd-detail'},React.createElement('div',{className:'pwd-key'},t.pwdLength),React.createElement('div',{className:'pwd-val'},result.length)),
          React.createElement('div',{className:'pwd-detail'},React.createElement('div',{className:'pwd-key'},t.pwdEntropy),React.createElement('div',{className:'pwd-val'},result.entropy,' bits')),
          React.createElement('div',{className:'pwd-detail'},React.createElement('div',{className:'pwd-key'},t.pwdCrackTime),React.createElement('div',{className:'pwd-val'},formatCrackTime(result.crackTime))),
          React.createElement('div',{className:'pwd-detail'},React.createElement('div',{className:'pwd-key'},t.pwdUpper+'/'+t.pwdLower),React.createElement('div',{className:'pwd-val'},result.upper+' / '+result.lower)),
          React.createElement('div',{className:'pwd-detail'},React.createElement('div',{className:'pwd-key'},t.pwdNumbers+'/'+t.pwdSymbols),React.createElement('div',{className:'pwd-val'},result.numbers+' / '+result.symbols))
        )
      ),
      suggestions.length>0&&React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udca1 ',t.pwdSuggestions),
        suggestions.map((s,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--cyan)'}},'\u2192 ',s))
      )
    )
  );
}

// ===== HEADER ANALYZER =====
function HeaderAnalyzer({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a URL','error');
    const ck=getCacheKey('headers',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*15,90)),400);
    try{
      const data=await callClaude(apiKey,
        'You are a web security header expert. Analyze HTTP security headers for the given URL. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"url":"string","found":[{"name":"string","value":"string","status":"good|warning|bad","description":"string"}],"missing":[{"name":"string","severity":"high|medium|low","description":"string","recommendation":"string"}],"score":number,"grade":"string","summary":"string"}. Provide 6-10 found headers, 4-6 missing headers. Score out of 100.',
        'Analyze security headers for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'headers',target,timestamp:Date.now()});
      addToast('Header analysis complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Header Report: '+result.url+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}.hdr{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}</style></head><body><h1>Header Report: '+result.url+'</h1><p>Score: '+result.score+'/100 ('+result.grade+')</p><h2>Found Headers</h2>'+(result.found||[]).map(h=>'<div class="hdr"><strong>'+h.name+'</strong>: '+h.value+' ['+h.status+']<br/>'+h.description+'</div>').join('')+'<h2>Missing Headers</h2>'+(result.missing||[]).map(h=>'<div class="hdr"><strong>'+h.name+'</strong> ['+h.severity+']<br/>'+h.description+'</div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='headers_'+result.url+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udce1 ',t.headersTitle)),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.headersPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.headersScanning:t.headersBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83c\udfaf ',t.headersScore,': ',result.score,'/100 (',result.grade,')')
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.headersFound),
        (result.found||[]).map((h,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('strong',{style:{color:h.status==='good'?'var(--green)':h.status==='warning'?'var(--yellow)':'var(--red)'}},h.name),
          React.createElement('div',{style:{fontFamily:'DM Mono',fontSize:'0.8rem',color:'var(--cyan)',margin:'4px 0'}},h.value),
          React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem'}},h.description)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u274c ',t.headersMissing),
        (result.missing||[]).map((h,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('span',{className:'severity '+h.severity},h.severity),' ',
          React.createElement('strong',null,h.name),
          React.createElement('div',{style:{color:'var(--text2)',marginTop:4,fontSize:'0.82rem'}},h.description),
          React.createElement('div',{style:{color:'var(--green)',marginTop:4,fontSize:'0.8rem'}},'\u2192 ',h.recommendation)
        ))
      )
    )
  );
}

// ===== METASPLOIT TOOL =====
function MetasploitTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a target','error');
    const ck=getCacheKey('metasploit',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a Metasploit Framework expert. Provide educational simulated analysis. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","modules":[{"name":"string","type":"exploit|auxiliary|post","platform":"string","rank":"excellent|great|good|normal|average","description":"string","usage":"string"}],"payloads":[{"name":"string","type":"string","description":"string"}],"attackPlan":[{"step":1,"command":"string","description":"string"}],"postExploitation":[{"action":"string","command":"string","description":"string"}],"recommendations":["string"],"summary":"string"}. Provide 4-6 modules, 3-4 payloads, 5-7 attack steps, 3-4 post-exploitation actions, 4-6 recommendations.',
        'Metasploit analysis for target: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'metasploit',target,timestamp:Date.now()});
      addToast('Metasploit analysis complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Metasploit: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}.mod{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}.cmd{background:#0a0a12;color:#0f8;padding:8px;border-radius:6px;margin:4px 0}</style></head><body><h1>Metasploit Report: '+result.target+'</h1><p>'+result.summary+'</p><h2>Modules</h2>'+(result.modules||[]).map(m=>'<div class="mod"><strong>'+m.name+'</strong> ['+m.type+'] ['+m.rank+']<br/>'+m.description+'<div class="cmd">'+m.usage+'</div></div>').join('')+'<h2>Attack Plan</h2>'+(result.attackPlan||[]).map(s=>'<div class="mod"><strong>Step '+s.step+'</strong>: '+s.description+'<div class="cmd">'+s.command+'</div></div>').join('')+'<h2>Recommendations</h2><ul>'+(result.recommendations||[]).map(r=>'<li>'+r+'</li>').join('')+'</ul></body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='metasploit_'+result.target+'.html';a.click();URL.revokeObjectURL(u);
  };

  const typeBadge=type=>{
    const cls=type==='exploit'?'exploit':type==='auxiliary'?'auxiliary':type==='post'?'post':'payload';
    return React.createElement('span',{className:'tool-badge '+cls},type.toUpperCase());
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83c\udfaf ',t.msTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.msDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.msPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.msScanning:t.msBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udce6 ',t.msModules,' (',(result.modules||[]).length,')'),
        (result.modules||[]).map((m,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6}},
            typeBadge(m.type),
            React.createElement('span',{className:'severity '+(m.rank==='excellent'?'critical':m.rank==='great'?'high':'medium')},m.rank),
            React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem'}},m.platform)
          ),
          React.createElement('strong',{style:{color:'var(--cyan)'}},m.name),
          React.createElement('div',{style:{color:'var(--text2)',marginTop:4,fontSize:'0.82rem'}},m.description),
          React.createElement('div',{className:'terminal-block'},React.createElement('span',{className:'cmd-prompt'},'msf6>'),React.createElement('code',null,m.usage))
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udca3 ',t.msPayloads),
        (result.payloads||[]).map((p,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('span',{className:'tool-badge payload'},p.type),
          React.createElement('strong',{style:{marginLeft:8,color:'var(--yellow)'}},p.name),
          React.createElement('div',{style:{color:'var(--text2)',marginTop:4,fontSize:'0.82rem'}},p.description)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee0\ufe0f ',t.msAttackPlan),
        (result.attackPlan||[]).map((s,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('span',{className:'cmd-step'},s.step),
          React.createElement('strong',null,s.description),
          React.createElement('code',{className:'cmd-text'},s.command)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udd0d ',t.msPostExploit),
        (result.postExploitation||[]).map((p,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('strong',{style:{color:'var(--orange)'}},p.action),
          React.createElement('div',{className:'cmd-desc'},p.description),
          React.createElement('code',{className:'cmd-text'},p.command)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.msRecommend),
        (result.recommendations||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--green)'}},'\u2192 ',r))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== BURP SUITE TOOL =====
function BurpSuiteTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a URL','error');
    const ck=getCacheKey('burpsuite',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a Burp Suite web security testing expert. Provide educational simulated web application security analysis. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"url":"string","vulnerabilities":[{"type":"string","severity":"critical|high|medium|low|info","location":"string","description":"string","evidence":"string","remediation":"string"}],"findings":[{"category":"string","count":1,"severity":"string"}],"siteMap":[{"path":"string","method":"GET|POST|PUT|DELETE","status":200,"notes":"string"}],"recommendations":["string"],"overallRisk":"critical|high|medium|low","score":0,"summary":"string"}. Provide 5-8 vulnerabilities, 4-6 finding categories, 6-10 site map entries, 5-7 recommendations. Score out of 100 (lower = more vulnerable).',
        'Burp Suite scan for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'burpsuite',target,timestamp:Date.now()});
      addToast('Burp Suite scan complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Burp Suite: '+result.url+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}.vuln{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}table{border-collapse:collapse;width:100%}td,th{border:1px solid #333;padding:8px}th{background:#222}</style></head><body><h1>Burp Suite Report: '+result.url+'</h1><p>Risk: '+result.overallRisk+' | Score: '+result.score+'/100</p><p>'+result.summary+'</p><h2>Vulnerabilities</h2>'+(result.vulnerabilities||[]).map(v=>'<div class="vuln"><strong>'+v.type+'</strong> ['+v.severity+'] at '+v.location+'<br/>'+v.description+'<br/><em>Evidence: '+v.evidence+'</em><br/><strong>Fix:</strong> '+v.remediation+'</div>').join('')+'<h2>Site Map</h2><table><tr><th>Path</th><th>Method</th><th>Status</th><th>Notes</th></tr>'+(result.siteMap||[]).map(s=>'<tr><td>'+s.path+'</td><td>'+s.method+'</td><td>'+s.status+'</td><td>'+s.notes+'</td></tr>').join('')+'</table></body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='burpsuite_'+result.url.replace(/[^a-zA-Z0-9]/g,'_')+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udd77\ufe0f ',t.bsTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.bsDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.bsPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.bsScanning:t.bsBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83c\udfaf ',t.bsRisk,': '),
        React.createElement('div',{style:{display:'flex',alignItems:'center',gap:12}},
          React.createElement('span',{className:'severity '+(result.overallRisk||'medium')},result.overallRisk),
          React.createElement('span',{style:{color:'var(--text2)',fontSize:'0.85rem'}},'Score: ',result.score,'/100')
        )
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udd13 ',t.bsVulns,' (',(result.vulnerabilities||[]).length,')'),
        (result.vulnerabilities||[]).map((v,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6}},
            React.createElement('span',{className:'severity '+v.severity},v.severity),
            React.createElement('strong',{style:{color:'var(--cyan)'}},v.type)
          ),
          React.createElement('div',{style:{color:'var(--text3)',fontSize:'0.78rem',marginBottom:4}},'\ud83d\udccd ',v.location),
          React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem'}},v.description),
          React.createElement('div',{className:'terminal-block'},React.createElement('code',null,v.evidence)),
          React.createElement('div',{style:{color:'var(--green)',fontSize:'0.8rem',marginTop:4}},'\u2192 ',v.remediation)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcca ',t.bsFindings),
        (result.findings||[]).map((f,i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10}},
          React.createElement('span',{className:'severity '+(f.severity||'info')},f.severity),
          React.createElement('span',{style:{flex:1}},f.category),
          React.createElement('span',{style:{fontFamily:'DM Mono',color:'var(--cyan)'}},f.count)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\uddfa\ufe0f ',t.bsSiteMap),
        (result.siteMap||[]).map((s,i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10,fontFamily:'DM Mono',fontSize:'0.8rem'}},
          React.createElement('span',{style:{color:s.method==='GET'?'var(--green)':s.method==='POST'?'var(--cyan)':s.method==='PUT'?'var(--yellow)':'var(--red)',fontWeight:600,minWidth:50}},s.method),
          React.createElement('span',{className:'severity '+(s.status<300?'info':s.status<400?'low':s.status<500?'medium':'high')},s.status),
          React.createElement('span',{style:{flex:1,color:'var(--green)'}},s.path),
          React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem'}},s.notes)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.bsRecommend),
        (result.recommendations||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--green)'}},'\u2192 ',r))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== WIRESHARK TOOL =====
function WiresharkTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a target','error');
    const ck=getCacheKey('wireshark',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a Wireshark network analysis expert. Provide educational simulated packet analysis. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","packets":[{"id":1,"protocol":"string","source":"string","destination":"string","info":"string","flags":"string","suspicious":false}],"protocolDistribution":[{"protocol":"string","percentage":10,"count":100,"color":"string"}],"anomalies":[{"type":"string","severity":"high|medium|low","description":"string","packetId":1}],"filters":[{"name":"string","expression":"string","description":"string"}],"summary":"string"}. Provide 10-15 packets, 5-7 protocols in distribution (percentages must sum to 100, use hex colors like #00ff88), 3-5 anomalies, 5-7 useful display filters.',
        'Wireshark analysis for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'wireshark',target,timestamp:Date.now()});
      addToast('Wireshark analysis complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Wireshark: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}table{border-collapse:collapse;width:100%}td,th{border:1px solid #333;padding:6px}th{background:#222}.sus{background:rgba(255,45,85,0.1);border-left:3px solid #f25}</style></head><body><h1>Wireshark Report: '+result.target+'</h1><p>'+result.summary+'</p><h2>Packets</h2><table><tr><th>#</th><th>Protocol</th><th>Source</th><th>Destination</th><th>Info</th></tr>'+(result.packets||[]).map(p=>'<tr class="'+(p.suspicious?'sus':'')+'"><td>'+p.id+'</td><td>'+p.protocol+'</td><td>'+p.source+'</td><td>'+p.destination+'</td><td>'+p.info+'</td></tr>').join('')+'</table><h2>Anomalies</h2>'+(result.anomalies||[]).map(a=>'<div style="margin:8px 0;padding:8px;background:#1a1a2e;border-radius:6px"><strong>['+a.severity+']</strong> '+a.type+': '+a.description+'</div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='wireshark_'+result.target+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83e\udd88 ',t.wsTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.wsDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.wsPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.wsScanning:t.wsBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcca ',t.wsProtocols),
        React.createElement('div',{className:'proto-bar'},
          (result.protocolDistribution||[]).map((p,i)=>React.createElement('div',{key:i,className:'proto-segment',style:{width:p.percentage+'%',background:p.color||'var(--cyan)'}},p.percentage>=8?p.protocol:''))
        ),
        React.createElement('div',{style:{display:'flex',flexWrap:'wrap',gap:8,marginTop:8}},
          (result.protocolDistribution||[]).map((p,i)=>React.createElement('div',{key:i,style:{display:'flex',alignItems:'center',gap:4,fontSize:'0.75rem'}},
            React.createElement('span',{style:{width:10,height:10,borderRadius:3,background:p.color||'var(--cyan)'}}),
            React.createElement('span',{style:{color:'var(--text2)'}},p.protocol,' (',p.percentage,'% - ',p.count,')')
          ))
        )
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udce6 ',t.wsPackets,' (',(result.packets||[]).length,')'),
        React.createElement('div',{className:'packet-row',style:{fontWeight:700,color:'var(--text3)',borderBottom:'1px solid var(--border)',marginBottom:8}},
          React.createElement('span',null,'#'),React.createElement('span',null,'Source'),React.createElement('span',null,'Dest'),React.createElement('span',null,'Info'),React.createElement('span',null,'Proto')
        ),
        (result.packets||[]).map((p,i)=>React.createElement('div',{key:i,className:'packet-row'+(p.suspicious?' suspicious':'')},
          React.createElement('span',{style:{color:'var(--text3)'}},p.id),
          React.createElement('span',{style:{color:'var(--text2)',fontSize:'0.72rem'}},p.source),
          React.createElement('span',{style:{color:'var(--text2)',fontSize:'0.72rem'}},p.destination),
          React.createElement('span',{style:{color:'var(--text)'}},p.info),
          React.createElement('span',{className:'proto'},p.protocol)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u26a0\ufe0f ',t.wsAnomalies),
        (result.anomalies||[]).map((a,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('span',{className:'severity '+a.severity},a.severity),
          React.createElement('strong',{style:{marginLeft:8}},a.type),
          React.createElement('div',{style:{color:'var(--text2)',marginTop:4,fontSize:'0.82rem'}},a.description),
          a.packetId&&React.createElement('span',{style:{fontSize:'0.75rem',color:'var(--text3)'}},'\ud83d\udce6 Packet #',a.packetId)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udd0d ',t.wsFilters),
        (result.filters||[]).map((f,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('strong',{style:{color:'var(--cyan)'}},f.name),
          React.createElement('code',{className:'cmd-text'},f.expression),
          React.createElement('div',{className:'cmd-desc'},f.description)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== JOHN THE RIPPER TOOL =====
function JohnTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a hash type','error');
    const ck=getCacheKey('john',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a John the Ripper password cracking expert. Provide educational analysis of hash types and cracking methodology. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"hashType":"string","methodology":[{"step":1,"command":"string","description":"string","estimatedTime":"string"}],"wordlists":[{"name":"string","size":"string","description":"string","effectiveness":"high|medium|low"}],"rules":[{"name":"string","description":"string","example":"string"}],"hashInfo":{"algorithm":"string","strength":"string","description":"string"},"estimatedTime":"string","recommendations":["string"],"summary":"string"}. Provide 5-7 methodology steps, 4-6 wordlists, 4-5 rules, 4-6 recommendations.',
        'John the Ripper analysis for hash type: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'john',target,timestamp:Date.now()});
      addToast('John analysis complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>John: '+result.hashType+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}.item{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}.cmd{background:#0a0a12;color:#0f8;padding:8px;border-radius:6px;margin:4px 0}</style></head><body><h1>John the Ripper: '+result.hashType+'</h1><p>'+result.summary+'</p><h2>Hash Info</h2><div class="item"><strong>'+result.hashInfo.algorithm+'</strong> - '+result.hashInfo.strength+'<br/>'+result.hashInfo.description+'</div><h2>Methodology</h2>'+(result.methodology||[]).map(m=>'<div class="item"><strong>Step '+m.step+':</strong> '+m.description+' ('+m.estimatedTime+')<div class="cmd">'+m.command+'</div></div>').join('')+'<h2>Recommendations</h2><ul>'+(result.recommendations||[]).map(r=>'<li>'+r+'</li>').join('')+'</ul></body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='john_'+result.hashType+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udd13 ',t.jrTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.jrDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.jrPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.jrScanning:t.jrBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      result.hashInfo&&React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcca ',t.jrHashInfo),
        React.createElement('div',{className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:10,marginBottom:8}},
            React.createElement('strong',{style:{color:'var(--cyan)',fontSize:'1.1rem'}},result.hashInfo.algorithm),
            React.createElement('span',{className:'severity '+(result.hashInfo.strength==='weak'||result.hashInfo.strength==='Weak'?'high':result.hashInfo.strength==='strong'||result.hashInfo.strength==='Strong'?'info':'medium')},result.hashInfo.strength)
          ),
          React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem'}},result.hashInfo.description)
        )
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee0\ufe0f ',t.jrMethodology),
        (result.methodology||[]).map((m,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('span',{className:'cmd-step'},m.step),
          React.createElement('strong',null,m.description),
          React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem',marginLeft:8}},'\u23f1 ',m.estimatedTime),
          React.createElement('code',{className:'cmd-text'},m.command)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcda ',t.jrWordlists),
        (result.wordlists||[]).map((w,i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10}},
          React.createElement('span',{className:'severity '+(w.effectiveness==='high'?'critical':w.effectiveness==='medium'?'medium':'low')},w.effectiveness),
          React.createElement('div',{style:{flex:1}},
            React.createElement('strong',{style:{color:'var(--cyan)'}},w.name),
            React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem',marginLeft:8}},w.size),
            React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem',marginTop:2}},w.description)
          )
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdc ',t.jrRules),
        (result.rules||[]).map((r,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('strong',{style:{color:'var(--orange)'}},r.name),
          React.createElement('div',{className:'cmd-desc'},r.description),
          React.createElement('code',{className:'cmd-text'},r.example)
        ))
      ),
      result.estimatedTime&&React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u23f1 ',t.jrTime),
        React.createElement('div',{className:'result-item',style:{color:'var(--yellow)',fontFamily:'DM Mono',fontSize:'1rem'}},result.estimatedTime)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.jrRecommend),
        (result.recommendations||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--green)'}},'\u2192 ',r))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== SQLMAP TOOL =====
function SQLMapTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a URL','error');
    const ck=getCacheKey('sqlmap',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a SQLMap SQL injection expert. Provide educational simulated SQL injection analysis. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","injectionPoints":[{"parameter":"string","type":"string","technique":"string","payload":"string","dbms":"string"}],"databases":[{"name":"string","tables":5,"info":"string"}],"commands":[{"step":1,"command":"string","description":"string"}],"wafDetected":false,"wafInfo":"string","riskLevel":"critical|high|medium|low","recommendations":["string"],"summary":"string"}. Provide 3-5 injection points, 3-5 databases, 5-8 commands, 4-6 recommendations.',
        'SQLMap analysis for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'sqlmap',target,timestamp:Date.now()});
      addToast('SQLMap analysis complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>SQLMap: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}.item{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}.cmd{background:#0a0a12;color:#0f8;padding:8px;border-radius:6px;margin:4px 0}</style></head><body><h1>SQLMap Report: '+result.target+'</h1><p>Risk Level: '+result.riskLevel+'</p><p>'+result.summary+'</p>'+(result.wafDetected?'<div style="padding:10px;background:#331;border:1px solid #ff0;border-radius:6px"><strong>WAF Detected:</strong> '+result.wafInfo+'</div>':'')+'<h2>Injection Points</h2>'+(result.injectionPoints||[]).map(ip=>'<div class="item"><strong>'+ip.parameter+'</strong> ['+ip.type+'] via '+ip.technique+'<br/>DBMS: '+ip.dbms+'<div class="cmd">'+ip.payload+'</div></div>').join('')+'<h2>Commands</h2>'+(result.commands||[]).map(c=>'<div class="item"><strong>Step '+c.step+':</strong> '+c.description+'<div class="cmd">'+c.command+'</div></div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='sqlmap_'+result.target.replace(/[^a-zA-Z0-9]/g,'_')+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udc89 ',t.sqTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.sqDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.sqPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.sqScanning:t.sqBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      result.wafDetected&&React.createElement('div',{className:'result-block',style:{borderColor:'rgba(255,214,0,0.3)',background:'rgba(255,214,0,0.05)'}},
        React.createElement('h3',{style:{color:'var(--yellow)'}},'\ud83d\udee1\ufe0f ',t.sqWaf,' - DETECTED'),
        React.createElement('p',{style:{color:'var(--yellow)',fontSize:'0.85rem'}},result.wafInfo)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83c\udfaf ',t.sqRisk,': '),
        React.createElement('span',{className:'severity '+(result.riskLevel||'medium'),style:{fontSize:'0.85rem'}},result.riskLevel)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udc89 ',t.sqInjections,' (',(result.injectionPoints||[]).length,')'),
        (result.injectionPoints||[]).map((ip,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:6}},
            React.createElement('strong',{style:{color:'var(--red)'}},ip.parameter),
            React.createElement('span',{className:'tool-badge exploit'},ip.type),
            React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem'}},ip.dbms)
          ),
          React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem'}},'\ud83c\udfaf Technique: ',ip.technique),
          React.createElement('div',{className:'terminal-block'},React.createElement('code',null,ip.payload))
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\uddc4\ufe0f ',t.sqDatabases),
        (result.databases||[]).map((db,i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10}},
          React.createElement('span',{style:{fontSize:'1.2rem'}},'\ud83d\uddc3\ufe0f'),
          React.createElement('div',{style:{flex:1}},
            React.createElement('strong',{style:{color:'var(--cyan)'}},db.name),
            React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem',marginLeft:8}},db.tables,' tables'),
            React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem',marginTop:2}},db.info)
          )
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee0\ufe0f ',t.sqCommands),
        (result.commands||[]).map((c,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('span',{className:'cmd-step'},c.step),
          React.createElement('strong',null,c.description),
          React.createElement('code',{className:'cmd-text'},c.command)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.sqRecommend),
        (result.recommendations||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--green)'}},'\u2192 ',r))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== HYDRA TOOL =====
function HydraTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a target','error');
    const ck=getCacheKey('hydra',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a Hydra brute force expert. Provide educational simulated brute force analysis. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","service":"string","methodology":[{"step":1,"command":"string","description":"string"}],"wordlists":[{"name":"string","type":"users|passwords","size":"string","source":"string"}],"options":[{"flag":"string","description":"string","recommended":true}],"defenses":[{"method":"string","effectiveness":"high|medium|low","description":"string"}],"estimatedTime":"string","recommendations":["string"],"summary":"string"}. Provide 5-7 methodology steps, 4-6 wordlists, 5-7 options, 4-6 defenses, 4-6 recommendations.',
        'Hydra brute force analysis for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'hydra',target,timestamp:Date.now()});
      addToast('Hydra analysis complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Hydra: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}.item{margin:8px 0;padding:10px;background:#1a1a2e;border-radius:8px}.cmd{background:#0a0a12;color:#0f8;padding:8px;border-radius:6px;margin:4px 0}table{border-collapse:collapse;width:100%}td,th{border:1px solid #333;padding:6px}th{background:#222}</style></head><body><h1>Hydra Report: '+result.target+' ('+result.service+')</h1><p>'+result.summary+'</p><h2>Methodology</h2>'+(result.methodology||[]).map(m=>'<div class="item"><strong>Step '+m.step+':</strong> '+m.description+'<div class="cmd">'+m.command+'</div></div>').join('')+'<h2>Defenses</h2>'+(result.defenses||[]).map(d=>'<div class="item"><strong>'+d.method+'</strong> ['+d.effectiveness+']<br/>'+d.description+'</div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='hydra_'+result.target.replace(/[^a-zA-Z0-9]/g,'_')+'.html';a.click();URL.revokeObjectURL(u);
  };

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udc09 ',t.hyTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.hyDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.hyPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.hyScanning:t.hyBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83c\udfaf Target: ',React.createElement('span',{style:{color:'var(--cyan)'}},result.target),' \u2014 ',React.createElement('span',{style:{color:'var(--orange)'}},result.service))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee0\ufe0f ',t.hyMethodology),
        (result.methodology||[]).map((m,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('span',{className:'cmd-step'},m.step),
          React.createElement('strong',null,m.description),
          React.createElement('code',{className:'cmd-text'},m.command)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcda ',t.hyWordlists),
        (result.wordlists||[]).map((w,i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10}},
          React.createElement('span',{className:'tool-badge '+(w.type==='users'?'auxiliary':'exploit')},w.type),
          React.createElement('div',{style:{flex:1}},
            React.createElement('strong',{style:{color:'var(--cyan)'}},w.name),
            React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem',marginLeft:8}},w.size),
            React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem',marginTop:2}},w.source)
          )
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2699\ufe0f ',t.hyOptions),
        (result.options||[]).map((o,i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10}},
          React.createElement('code',{style:{color:'var(--green)',fontFamily:'DM Mono',minWidth:60}},o.flag),
          React.createElement('span',{style:{flex:1,color:'var(--text2)',fontSize:'0.82rem'}},o.description),
          o.recommended&&React.createElement('span',{className:'severity info'},'\u2713')
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee1\ufe0f ',t.hyDefenses),
        (result.defenses||[]).map((d,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:4}},
            React.createElement('strong',null,d.method),
            React.createElement('span',{className:'severity '+(d.effectiveness==='high'?'info':d.effectiveness==='medium'?'medium':'high')},d.effectiveness)
          ),
          React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem'}},d.description)
        ))
      ),
      result.estimatedTime&&React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u23f1 ',t.hyTime),
        React.createElement('div',{className:'result-item',style:{color:'var(--yellow)',fontFamily:'DM Mono',fontSize:'1rem'}},result.estimatedTime)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.hyRecommend),
        (result.recommendations||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--green)'}},'\u2192 ',r))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== GOBUSTER TOOL =====
function GobusterTool({t,apiKey,addToast,addHistory,offlineMode}){
  const[target,setTarget]=useState('');
  const[loading,setLoading]=useState(false);
  const[progress,setProgress]=useState(0);
  const[result,setResult]=useState(null);

  const scan=async()=>{
    if(!target.trim())return addToast('Enter a URL','error');
    const ck=getCacheKey('gobuster',target);
    const cached=localStorage.getItem(ck);
    if(offlineMode&&cached){setResult(JSON.parse(cached));return}
    if(!apiKey)return addToast(t.noKey,'error');
    setLoading(true);setProgress(0);setResult(null);
    const iv=setInterval(()=>setProgress(p=>Math.min(p+Math.random()*12,90)),500);
    try{
      const data=await callClaude(apiKey,
        'You are a Gobuster directory/file brute force expert. Provide educational simulated directory enumeration analysis. Respond ONLY with valid JSON. Do not include any text outside the JSON object. Format: {"target":"string","directories":[{"path":"string","status":200,"size":"string","type":"dir|file","interesting":false}],"commands":[{"mode":"dir|dns|vhost|fuzz","command":"string","description":"string"}],"wordlists":[{"name":"string","entries":"string","focus":"string"}],"hiddenFindings":[{"path":"string","description":"string","risk":"high|medium|low"}],"recommendations":["string"],"summary":"string"}. Provide 10-15 directories, 4-6 commands covering different modes, 4-5 wordlists, 3-5 hidden findings, 4-6 recommendations.',
        'Gobuster scan for: '+target
      );
      setResult(data);
      localStorage.setItem(ck,JSON.stringify(data));
      addHistory({type:'gobuster',target,timestamp:Date.now()});
      addToast('Gobuster scan complete','success');
    }catch(e){addToast(e.message,'error')}
    finally{clearInterval(iv);setProgress(100);setTimeout(()=>setLoading(false),500)}
  };

  const exportReport=()=>{
    if(!result)return;
    const html='<html><head><title>Gobuster: '+result.target+'</title><style>body{background:#111;color:#eee;font-family:monospace;padding:20px}h1{color:#0f8}h2{color:#0df;margin-top:16px}.item{margin:4px 0;padding:8px;background:#1a1a2e;border-radius:6px}.int{border-left:3px solid #fd0;background:rgba(255,214,0,0.03)}.cmd{background:#0a0a12;color:#0f8;padding:8px;border-radius:6px;margin:4px 0}</style></head><body><h1>Gobuster Report: '+result.target+'</h1><p>'+result.summary+'</p><h2>Directories/Files</h2>'+(result.directories||[]).map(d=>'<div class="item '+(d.interesting?'int':'')+'"><span style="color:'+(d.status===200?'#0f8':d.status===301?'#0df':d.status===403?'#f80':'#f25')+'">['+d.status+']</span> '+d.path+' ('+d.size+') ['+(d.type)+']</div>').join('')+'<h2>Hidden Findings</h2>'+(result.hiddenFindings||[]).map(h=>'<div class="item int"><strong>'+h.path+'</strong> ['+h.risk+']<br/>'+h.description+'</div>').join('')+'</body></html>';
    const b=new Blob([html],{type:'text/html'});const u=URL.createObjectURL(b);const a=document.createElement('a');a.href=u;a.download='gobuster_'+result.target.replace(/[^a-zA-Z0-9]/g,'_')+'.html';a.click();URL.revokeObjectURL(u);
  };

  const statusClass=s=>s===200?'s200':s===301?'s301':s===403?'s403':'s500';

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},React.createElement('h2',null,'\ud83d\udcc1 ',t.gbTitle)),
      React.createElement('div',{className:'disclaimer'},'\u26a0\ufe0f ',t.gbDisclaimer),
      React.createElement('div',{className:'input-group'},
        React.createElement('input',{className:'input-field',value:target,onChange:e=>setTarget(e.target.value),placeholder:t.gbPlaceholder,onKeyDown:e=>e.key==='Enter'&&scan()}),
        React.createElement('button',{className:'btn btn-primary',onClick:scan,disabled:loading},loading?t.gbScanning:t.gbBtn)
      ),
      loading&&React.createElement(ProgressBar,{progress}),
      loading&&React.createElement(LoadingSkeleton,null)
    ),
    result&&React.createElement('div',{className:'result-section'},
      React.createElement('div',{className:'toolbar'},
        React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:exportReport},'\ud83d\udcc4 ',t.export)
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcc2 ',t.gbDirs,' (',(result.directories||[]).length,')'),
        (result.directories||[]).map((d,i)=>React.createElement('div',{key:i,className:'dir-item'+(d.interesting?' interesting':'')},
          React.createElement('span',{className:'dir-status '+statusClass(d.status)},d.status),
          React.createElement('span',{className:'dir-path'},d.path),
          React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.72rem'}},d.size),
          React.createElement('span',{style:{color:d.type==='dir'?'var(--cyan)':'var(--text3)',fontSize:'0.72rem'}},d.type==='dir'?'\ud83d\udcc1':'\ud83d\udcc4'),
          d.interesting&&React.createElement('span',{style:{color:'var(--yellow)',fontSize:'0.7rem'}},'\u2b50')
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udee0\ufe0f ',t.gbCommands),
        (result.commands||[]).map((c,i)=>React.createElement('div',{key:i,className:'command-item'},
          React.createElement('span',{className:'tool-badge '+(c.mode==='dir'?'exploit':c.mode==='dns'?'auxiliary':c.mode==='vhost'?'post':'payload')},c.mode),
          React.createElement('div',{className:'cmd-desc',style:{marginLeft:0,marginTop:4}},c.description),
          React.createElement('div',{className:'terminal-block'},React.createElement('span',{className:'cmd-prompt'},'$'),React.createElement('code',null,c.command))
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcda ',t.gbWordlists),
        (result.wordlists||[]).map((w,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('strong',{style:{color:'var(--cyan)'}},w.name),
          React.createElement('span',{style:{color:'var(--text3)',fontSize:'0.75rem',marginLeft:8}},w.entries,' entries'),
          React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem',marginTop:2}},w.focus)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udd0d ',t.gbHidden),
        (result.hiddenFindings||[]).map((h,i)=>React.createElement('div',{key:i,className:'result-item'},
          React.createElement('div',{style:{display:'flex',alignItems:'center',gap:8,marginBottom:4}},
            React.createElement('span',{className:'severity '+(h.risk==='high'?'high':h.risk==='medium'?'medium':'low')},h.risk),
            React.createElement('strong',{style:{color:'var(--yellow)'}},h.path)
          ),
          React.createElement('div',{style:{color:'var(--text2)',fontSize:'0.82rem'}},h.description)
        ))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\u2705 ',t.gbRecommend),
        (result.recommendations||[]).map((r,i)=>React.createElement('div',{key:i,className:'result-item',style:{color:'var(--green)'}},'\u2192 ',r))
      ),
      React.createElement('div',{className:'result-block'},
        React.createElement('h3',null,'\ud83d\udcdd Summary'),
        React.createElement('p',{style:{color:'var(--text2)',fontSize:'0.85rem',lineHeight:1.6}},result.summary)
      )
    )
  );
}

// ===== STATS TAB =====
function StatsTab({t,history,setHistory}){
  const[favs,setFavs]=useState(()=>{try{return JSON.parse(localStorage.getItem('cyberscan_favs')||'[]')}catch{return[]}});

  const toggleFav=useCallback(id=>{
    setFavs(prev=>{
      const next=prev.includes(id)?prev.filter(f=>f!==id):[...prev,id];
      localStorage.setItem('cyberscan_favs',JSON.stringify(next));
      return next;
    });
  },[]);

  const clearAll=()=>{
    if(confirm(t.clearConfirm)){
      setHistory([]);localStorage.removeItem('cyberscan_history');
      setFavs([]);localStorage.removeItem('cyberscan_favs');
    }
  };

  const typeIcon=type=>{
    const icons={scanner:'\ud83d\udd0d',vuln:'\ud83d\udee1\ufe0f',password:'\ud83d\udd10',headers:'\ud83d\udce1',metasploit:'\ud83c\udfaf',burpsuite:'\ud83d\udd77\ufe0f',wireshark:'\ud83e\udd88',john:'\ud83d\udd13',sqlmap:'\ud83d\udc89',hydra:'\ud83d\udc09',gobuster:'\ud83d\udcc1'};
    return icons[type]||'\ud83d\udd0d';
  };
  const typeLabel=type=>{
    const labels={scanner:'Scanner',vuln:'Vuln',password:'Password',headers:'Headers',metasploit:'Metasploit',burpsuite:'Burp Suite',wireshark:'Wireshark',john:'John',sqlmap:'SQLMap',hydra:'Hydra',gobuster:'Gobuster'};
    return labels[type]||type;
  };

  const counts=useMemo(()=>{
    const c={};
    history.forEach(h=>{c[h.type]=(c[h.type]||0)+1});
    return c;
  },[history]);

  const topTypes=useMemo(()=>{
    return Object.entries(counts).sort((a,b)=>b[1]-a[1]).slice(0,6);
  },[counts]);

  const mostScanned=useMemo(()=>{
    const m={};
    history.forEach(h=>{m[h.target]=(m[h.target]||0)+1});
    return Object.entries(m).sort((a,b)=>b[1]-a[1]).slice(0,5);
  },[history]);

  const favItems=useMemo(()=>history.filter(h=>favs.includes(h.id)),[history,favs]);

  return React.createElement('div',{className:'fade-in'},
    React.createElement('div',{className:'card'},
      React.createElement('div',{className:'card-header'},
        React.createElement('h2',null,'\ud83d\udcca ',t.statsTitle),
        React.createElement('div',{style:{flex:1}}),
        React.createElement('button',{className:'btn btn-danger btn-sm',onClick:clearAll},t.clearHistory)
      )
    ),
    React.createElement('div',{className:'stats-grid'},
      React.createElement('div',{className:'stat-card'},
        React.createElement('div',{className:'stat-icon'},'\ud83d\udcca'),
        React.createElement('div',{className:'stat-value'},history.length),
        React.createElement('div',{className:'stat-label'},t.totalScans)
      ),
      React.createElement('div',{className:'stat-card'},
        React.createElement('div',{className:'stat-icon'},'\u2b50'),
        React.createElement('div',{className:'stat-value'},favItems.length),
        React.createElement('div',{className:'stat-label'},t.favorites)
      ),
      topTypes.map(([type,count])=>React.createElement('div',{key:type,className:'stat-card'},
        React.createElement('div',{className:'stat-icon'},typeIcon(type)),
        React.createElement('div',{className:'stat-value'},count),
        React.createElement('div',{className:'stat-label'},typeLabel(type))
      ))
    ),
    mostScanned.length>0&&React.createElement('div',{className:'result-block'},
      React.createElement('h3',null,'\ud83c\udfaf ',t.mostScanned),
      mostScanned.map(([target,count],i)=>React.createElement('div',{key:i,className:'result-item',style:{display:'flex',alignItems:'center',gap:10}},
        React.createElement('span',{style:{fontFamily:'DM Mono',color:'var(--cyan)',fontWeight:600,minWidth:30}},count,'x'),
        React.createElement('span',{style:{flex:1,fontFamily:'DM Mono',fontSize:'0.82rem'}},target)
      ))
    ),
    React.createElement('div',{className:'result-block'},
      React.createElement('h3',null,'\ud83d\udcdc ',history.length>0?'History':''),
      history.length===0&&React.createElement('p',{style:{color:'var(--text3)',textAlign:'center',padding:20}},t.noHistory),
      history.slice().reverse().slice(0,50).map(h=>React.createElement('div',{key:h.id,className:'history-item'},
        React.createElement('span',{className:'hi-icon'},typeIcon(h.type)),
        React.createElement('span',{className:'hi-target'},h.target),
        React.createElement('span',{style:{fontSize:'0.68rem',color:'var(--text3)',padding:'2px 6px',background:'var(--bg3)',borderRadius:4}},typeLabel(h.type)),
        React.createElement('span',{className:'hi-time'},new Date(h.timestamp).toLocaleString()),
        React.createElement('span',{className:'hi-fav'+(favs.includes(h.id)?' active':''),onClick:e=>{e.stopPropagation();toggleFav(h.id)}},favs.includes(h.id)?'\u2605':'\u2606')
      ))
    )
  );
}

// ===== MAIN APP =====
function App(){
  const[lang,setLang]=useState(()=>localStorage.getItem('cyberscan_lang')||'ht');
  const[tab,setTab]=useState('scanner');
  const[apiKey,setApiKey]=useState(()=>localStorage.getItem('cyberscan_apikey')||'');
  const[showSettings,setShowSettings]=useState(false);
  const[offlineMode,setOfflineMode]=useState(false);
  const[isOnline,setIsOnline]=useState(navigator.onLine);
  const[toasts,setToasts]=useState([]);
  const[history,setHistory]=useState(()=>{try{return JSON.parse(localStorage.getItem('cyberscan_history')||'[]')}catch{return[]}});

  const t=T[lang]||T.ht;

  useEffect(()=>{localStorage.setItem('cyberscan_lang',lang)},[lang]);
  useEffect(()=>{initMatrix()},[]);
  useEffect(()=>{
    const on=()=>setIsOnline(true);
    const off=()=>setIsOnline(false);
    window.addEventListener('online',on);window.addEventListener('offline',off);
    return()=>{window.removeEventListener('online',on);window.removeEventListener('offline',off)};
  },[]);

  const addToast=useCallback((message,type='info')=>{
    const id=generateId();
    setToasts(prev=>[...prev,{id,message,type,exiting:false}]);
    setTimeout(()=>{
      setToasts(prev=>prev.map(t=>t.id===id?{...t,exiting:true}:t));
      setTimeout(()=>setToasts(prev=>prev.filter(t=>t.id!==id)),300);
    },3000);
  },[]);

  const removeToast=useCallback(id=>{
    setToasts(prev=>prev.map(t=>t.id===id?{...t,exiting:true}:t));
    setTimeout(()=>setToasts(prev=>prev.filter(t=>t.id!==id)),300);
  },[]);

  const addHistory=useCallback(entry=>{
    const item={...entry,id:generateId()};
    setHistory(prev=>{
      const next=[...prev,item];
      localStorage.setItem('cyberscan_history',JSON.stringify(next.slice(-200)));
      return next.slice(-200);
    });
  },[]);

  const tabItems=[
    {id:'scanner',icon:'\ud83d\udd0d',label:t.scanner},
    {id:'vuln',icon:'\ud83d\udee1\ufe0f',label:t.vuln},
    {id:'password',icon:'\ud83d\udd10',label:t.password},
    {id:'headers',icon:'\ud83d\udce1',label:t.headers},
    {id:'metasploit',icon:'\ud83c\udfaf',label:t.metasploit},
    {id:'burpsuite',icon:'\ud83d\udd77\ufe0f',label:t.burpsuite},
    {id:'wireshark',icon:'\ud83e\udd88',label:t.wireshark},
    {id:'john',icon:'\ud83d\udd13',label:t.john},
    {id:'sqlmap',icon:'\ud83d\udc89',label:t.sqlmap},
    {id:'hydra',icon:'\ud83d\udc09',label:t.hydra},
    {id:'gobuster',icon:'\ud83d\udcc1',label:t.gobuster},
    {id:'stats',icon:'\ud83d\udcca',label:t.stats}
  ];

  const needsApi=tab!=='password'&&tab!=='stats';
  const effOffline=offlineMode&&!isOnline;

  const commonProps={t,apiKey,addToast,addHistory,offlineMode:effOffline};

  return React.createElement('div',{className:'app-container'},
    React.createElement(ToastContainer,{toasts,removeToast}),
    showSettings&&React.createElement(SettingsModal,{t,apiKey,setApiKey,lang,setLang,offlineMode,setOfflineMode,onClose:()=>setShowSettings(false)}),

    // Header
    React.createElement('div',{className:'header'},
      React.createElement('h1',null,t.title),
      React.createElement('p',null,t.subtitle)
    ),

    // Language bar + settings
    React.createElement('div',{style:{display:'flex',justifyContent:'center',alignItems:'center',gap:8,marginBottom:12}},
      React.createElement('div',{className:'lang-bar'},
        ['ht','fr','en'].map(l=>React.createElement('button',{key:l,className:'lang-btn'+(lang===l?' active':''),onClick:()=>setLang(l)},l.toUpperCase()))
      ),
      React.createElement('button',{className:'btn btn-secondary btn-sm',onClick:()=>setShowSettings(true)},'\u2699\ufe0f')
    ),

    // Tab bar
    React.createElement('div',{className:'tab-bar'},
      tabItems.map(ti=>React.createElement('button',{key:ti.id,className:'tab-btn'+(tab===ti.id?' active':''),onClick:()=>setTab(ti.id)},
        React.createElement('span',null,ti.icon),
        React.createElement('span',{className:'tab-label'},ti.label)
      ))
    ),

    // API warning
    needsApi&&!apiKey&&React.createElement('div',{className:'api-warning'},
      t.noKey,' ',React.createElement('a',{onClick:()=>setShowSettings(true)},t.getKey)
    ),

    // Tab content
    tab==='scanner'&&React.createElement(NetworkScanner,commonProps),
    tab==='vuln'&&React.createElement(VulnCheck,commonProps),
    tab==='password'&&React.createElement(PasswordAnalyzer,{t}),
    tab==='headers'&&React.createElement(HeaderAnalyzer,commonProps),
    tab==='metasploit'&&React.createElement(MetasploitTool,commonProps),
    tab==='burpsuite'&&React.createElement(BurpSuiteTool,commonProps),
    tab==='wireshark'&&React.createElement(WiresharkTool,commonProps),
    tab==='john'&&React.createElement(JohnTool,commonProps),
    tab==='sqlmap'&&React.createElement(SQLMapTool,commonProps),
    tab==='hydra'&&React.createElement(HydraTool,commonProps),
    tab==='gobuster'&&React.createElement(GobusterTool,commonProps),
    tab==='stats'&&React.createElement(StatsTab,{t,history,setHistory}),

    // Footer
    React.createElement('div',{className:'footer'},'CyberScan AI v2.0 \u2014 Educational Cybersecurity Analysis Tool')
  );
}

// ===== RENDER =====
const root=ReactDOM.createRoot(document.getElementById('root'));
root.render(React.createElement(App,null));
</script>
</body>
</html>
